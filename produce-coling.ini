[]
default =
  data/COLING/exp.300/dev.eval

[data/fastText/%{lang}/cc.%{lang}.300.bin.gz]
recipe =
  mkdir -p $(dirname %{target})
  wget https://dl.fbaipublicfiles.com/fasttext/vectors-crawl/cc.%{lang}.300.bin.gz -P $(dirname %{target})

[data/fastText/%{lang}/%{name}.bin]
dep.gz = data/fastText/%{lang}/%{name}.bin.gz
recipe =
  gunzip %{gz} -c > %{target}

[data/COLING/%{exp}.%{dim}/model.pth]
dep.fastText = data/fastText/en/cc.en.%{dim}.bin
dep.french_twg = TWG-COLING/data/twg_grammar
dep.train = %{french_twg}/twg_train.supertags
dep.dev = %{french_twg}/twg_dev.supertags
recipe =
  mkdir -p $(dirname %{target})
  python -m supertagger train --emb %{dim} -t %{train} -d %{dev} -f %{fastText} --save %{target}

[data/COLING/%{exp}.%{dim}/%{part}.pred.supertags]
dep.fastText = data/fastText/en/cc.en.%{dim}.bin
dep.french_twg = TWG-COLING/data/twg_grammar
dep.input = %{french_twg}/twg_%{part}.supertags
dep.model = data/COLING/%{exp}.%{dim}/model.pth
recipe =
  python -m supertagger tag -i %{input} -l %{model} -f %{fastText} > %{target}

[data/COLING/%{exp}.%{dim}/%{part}.eval]
dep.french_twg = TWG-COLING/data/twg_grammar
dep.gold = %{french_twg}/twg_%{part}.supertags
dep.pred = data/COLING/%{exp}.%{dim}/%{part}.pred.supertags
recipe =
#   python -m supertagger eval --gold %{gold} --pred %{pred} > %{target}
#   cat %{target}
  python -m supertagger eval --gold %{gold} --pred %{pred}
